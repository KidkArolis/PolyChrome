<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Hello PolyML</title>

<!--
<script type="application/x-polyml">
	fun f () = print "Hello PolyML\n";
	f();
	//debugging?
</script>
-->

<style type= "text/css">
    body, html {
        padding:0;
        margin:0;
        font-family: verdana, sans;
        font-size:12px;
    }
    pre {
        margin:0;
    }
    #code {
        padding:20px;
        background-color:#eee;
        border-bottom:1px solid #ccc;
    }
    #body { padding:20px; }
</style> 

</head>
<body>

<div id="body">
    <p id="abc">0</p>
    <input id="button" type="button" value="add one" />
    <p id="abc2">0</p>
    <input id="button2" type="button" value="subtract one" />
    
    <hr />
    <input id="remove1" type="button" value="remove first listener" />
    <input id="remove2" type="button" value="remove second listener" />
</div>

<pre id="code">
fun addOne() =
    let
        val current_value = valOf (Int.fromString(js "document.getElementById('abc').innerHTML"));
        val new_value = current_value + 1;
        val new_text = Int.toString new_value;
    in
        js ("document.getElementById('abc').innerHTML = '"^new_text^"'")
    end;
addEventListener "button" "click" "addOne();";

fun subtractOne() =
    let
        val current_value = valOf (Int.fromString(js "document.getElementById('abc2').innerHTML"));
        val new_value = current_value - 1;
        val new_text = Int.toString new_value;
        val _ = addEventListener "button" "click" "addOne();";
    in
        js ("document.getElementById('abc2').innerHTML = '"^new_text^"'")
    end;
addEventListener "button2" "click" "subtractOne();";

fun remove1() =
    removeEventListener "button" "click" "addOne();";
fun remove2() =
    removeEventListener "button2" "click" "subtractOne();";

addEventListener "remove1" "click" "remove1();";
addEventListener "remove2" "click" "remove2();";

</pre>
</body>
</html>
