<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>jQuery Wrapper demo</title>

<script type="text/javascript" src="jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="jQueryWrapper.js"></script>

<script type="type/javascript">

</script>

<script type="application/x-polyml">
open DOM


(* this could be an external file when thats possible *)
structure jQueryWrapper =
struct
    val w = "jQueryWrapper"
    fun $ (selector) = let
            val req = JSONReqStr w "select" [JSON.String selector]
            val _ = send(req)
        in parse_element_list (recv()) end
end
open jQueryWrapper;



(* this is the actual application of the custom wrapper *)
fun setColorGreen (e) = let in setStyle e "color" "green"; e end
fun setColorOrange (e) = let in setStyle e "color" "#FF6600"; e end

val greenElements = $("p.green");
val orangeElements = $("p.orange");

map setColorGreen greenElements;
map setColorOrange orangeElements;

</script>

<style type= "text/css">
    body, html {
        padding:0;
        margin:0;
        font-family: verdana, sans;
        font-size:12px;
        text-align:center;
        padding:30px;
    }
    #description {
        text-align:left;
    }
</style>

</head>
<body>

<p class="green">This text should be green color</p>
<p class="orange">This text should be orange color</p>
<p class="green">This text should be green color</p>
<p class="orange">This text should be orange color</p>

<hr />
<div id="description">
<p>Demo description:</p>
<ul>
<li>Custom wrapper consisting of a JS snippet and Poly snippet is used here to use functions from jQuery library.</li>
<li>Notice how a list with elements is returned to Poly.</li>
</ul>
</div>

</body>
</html>

